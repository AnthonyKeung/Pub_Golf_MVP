{% extends "layout.html" %}
{% block body %}
<script src="https://www.paypal.com/sdk/js?client-id=ATlzYRh2ppFMu9jC1ejic_EPkqVaD_zcBqekHT-NKysWKifAHUpnvsdrAoVHXB7M_kRA2d9CurG8U5ge&currency=GBP"></script>
    <div class="section page">

        <div class="container">

                <h1 style="font-size: x-large; font-weight: bolder;">Checkout for 8 Hole Package Â£40</h1>



                <form id="checkout-form">

                   
                        <div class="form-group">
                          <label for="formGroupExampleInput">Name</label>
                          <input type="text" class="form-control" id="formGroupExampleInput" placeholder="">
                        </div>
                        <div class="form-group">
                          <label for="formGroupExampleInput2">Uni Email</label>
                          <input type="text" class="form-control" id="formGroupExampleInput2" placeholder="">
                        </div>
                        <div class="form-group">
                            <label for="formGroupExampleInput2">Society (if applicable)</label>
                            <input type="text" class="form-control" id="formGroupExampleInput2" placeholder="">
                          </div>
                          <table style="margin-top: 2%;">
                            <tr>
                                    <th>
                                            <input type="hidden" name="quantity" value="quantity">
                                            <label for="quantity">Quantity</label>
                                    </th>
                                    <td>
                                        <select name="quantity" id="quantity">
                                            {%  for quan in quantity %}
                                                    <option value="{{ quan }}">{{ quan }} </option>
                                            {% endfor %}
                                    </select>
                                    </td>
                            </tr>
                            </table>
                        

                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="" id="check">
                            <label class="form-check-label" for="flexCheckDefault">
                            Must Accept <a href="#" onClick="MyWindow=window.open('/termsandconditions','MyWindow','width=600,height=300');">Terms and Conditions</a>
                            </label>
                        </div>
                    


<!-- Set up a container element for the button -->
<div id="paypal-button-container"></div>
<script>
    paypal.Buttons({

        onInit: function(data, actions) {
      // Disable the buttons
      actions.disable();
      // Listen for changes to the checkbox
      document.querySelector('#check')
        .addEventListener('change', function(event) {
          // Enable or disable the button when it is checked or unchecked
          if (event.target.checked) {
            actions.enable();
          } else {
            actions.disable();
          }
        });
    },
    
        // Sets up the transaction when a payment button is clicked
    createOrder: (data, actions) => {
            return actions.order.create({
                purchase_units: [{
                    amount: {
                        value: '30' // Can also reference a variable or function
                    }

                }],
                items:[		{
                        name:"6 Hole Package",
		            description:"6 Drinks at 6 Pubs, at a Discounted Price",
                    quantity: document.getElementById("quantity").value,
                    unit_amount:{
			            value:"30",
			            currency_code:"GBP"
			        }
                    }],
            });
    },
        // Finalize the transaction after payer approval
    onApprove: (data, actions) => {
            return actions.order.capture().then(function (orderData) {
                // Successful capture! For dev/demo purposes:
                

                console.log('Capture result', orderData, JSON.stringify(orderData, null, 2));
                const transaction = orderData.purchase_units[0].payments.captures[0];
                alert(`Transaction ${transaction.status}: ${transaction.id}\n\nSee console for all available details`);
                // When ready to go live, remove the alert and show a success message within this page. For example:
                // const element = document.getElementById('paypal-button-container');
                // element.innerHTML = '<h3>Thank you for your payment!</h3>';
                // Or go to another URL:  actions.redirect('thank_you.html');
            });
        }
    }).render('#paypal-button-container');
</script>
                    
                </form>
            </div>
        </div>
    </div>
{% endblock %}